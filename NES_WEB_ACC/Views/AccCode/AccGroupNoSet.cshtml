
@{
    ViewBag.Title = "科目類別設定";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section css{
    <style>
        /*#region container_ToolBar style*/
        .header-toolbar {
            overflow: auto;
            font-size: 0.9em;
            padding: 1px 15px 1px 3px;
            width: 100%;
            background-color: #cfcfcf;
            margin: 0;
            border: 1px solid gray;
        }

            .header-toolbar .easyui-linkbutton {
                width: 50px;
                height: 52px;
                font-size: 0.9em;
                font-weight: bold;
                margin: 0px;
                padding: 0px;
            }

            .header-toolbar .linkbtn2 {
                width: 45px;
            }

            .header-toolbar .linkbtn4 {
                width: 70px;
            }

            .header-toolbar .l-btn-text {
                font-size: 12px !important;
                margin-top: 28px !important;
            }

            .header-toolbar .l-btn-icon {
                width: 24px !important;
                height: 24px !important;
                left: 60% !important;
            }

        .separatorbar {
            margin-right: 50px;
        }
        /*#endregion*/

        /*#region container_body style*/
        #body-container {
            width: 100%;
            height: calc(100vh - 130px);
            background-color: #d0d0d0;
            margin: 0px;
            padding: 0px;
            font-size: 1.0em;
            overflow: hidden;
        }

        .body-layout {
            height: calc(100vh - 130px);
            width: 100%;
        }
        /*#endregion*/

    </style>
}


@{ Html.RenderAction("_ToolBarPartial"); }

<div id="body-container">
    <div class="easyui-layout body-layout">
        <div data-options="region:'west',collapsible:false" title="會計大類" style="width:50%;">
            <table id="dgGroup" class="datagrid easyui-subdg" style="width:100%;height:99%;">
            </table>
        </div>

        <div data-options="region:'east',collapsible:false" title="會計分類" style="width:50%;">
            <table id="dgNo" class="datagrid easyui-maindg" style="width:100%;height:99%;">
            </table>
        </div>
    </div>
</div>

@section Scripts {

    <script src="~/Scripts/easyui/jquery.easyui.min.js"></script>
    <script>
        ///-----基本參數-----///
        //#region 基本參數
        var controllerurl = '/AccCode', functionurl = "/", actionurl = "";
        var dgGroup = $('#dgGroup'),   //左側列表_會計大類
            dgNo = $('#dgNo'),      //右側列表_會計分類
            focusdg = null;


        ///----初始化----------///
        //#region 初始化
        $(function () {
            //左側列表欄位
            dgGroupSet();

            //右側列表欄位
            dgNoSet();

        });
        //#endregion

        //#region dg設定與填值
        //dg會計大類，欄位與功能
        function dgGroupSet() {
            dgGroup.datagrid({
                singleSelect: true,
                columns: [[
                    { field: 'Id', title: 'Id', hidden: true },
                    { field: 'AccGroupNo', title: '科目大類編號', width: 70, editor: { type: 'text' } },
                    { field: 'AccGroupNameC', title: '科目大類中文名稱', width: 150, editor: { type: 'text' } },
                    { field: 'AccGroupNameE', title: '科目大類英文名稱', width: 150, editor: { type: 'text' } }
                ]],
                onSelect: function (index, row) {
                    dgNodata(row.Id);
                },
                onClickRow: function (rowIndex, rowData) {
                    // 將 dgGroup 的背景顏色設為黃色
                    dgGroup.datagrid('getPanel').css({
                        'border-color': 'yellow',
                        'border-width': '5px', // 设置边框宽度为2像素，你可以根据需要调整宽度值
                        'border-style': 'solid' // 设置边框样式为实线
                    });
                    // 將其他 DataGrid 的背景顏色設為白色
                    dgNo.datagrid('getPanel').css({
                        'border-color': 'white',
                        'border-width': '0px', // 设置边框宽度为2像素，你可以根据需要调整宽度值
                        'border-style': 'solid' // 设置边框样式为实线
                    });
                    focusdg = 'dgGroup';
                },
                // 啟用編輯列功能
                editing: true
            });
            dgGroupdata();
        }
        //dg會計大類，填值
        function dgGroupdata() {
            actionurl = defaultUrl + controllerurl + functionurl + 'GetAccCode1';
            doajax("GET", actionurl, null, function (data) {
                if (data == "C0003") {
                    $.messager.alert('alert', '無會計大類資料!');
                    console.log("C0003: Not Found");
                } else {
                    dgGroup.datagrid('loadData', data);
                }
            });
        }
        //dg會計分類，欄位與功能
        function dgNoSet() {
            dgNo.datagrid({
                singleSelect: true,
                columns: [[
                    { field: 'Id', title: 'Id', hidden: true },
                    { field: 'AccNoBy', title: '科目分類編號', width: 70 },
                    { field: 'AccNoByNameC', title: '科目分類中文名稱', width: 100 },
                    { field: 'AccNoByNameE', title: '科目分類英文名稱', width: 100 },
                    { field: 'DCTypeNo', title: '借貸方向', width: 50 },
                    { field: 'DCTypeNameC', title: '借貸名稱', width: 50 },
                    { field: 'AccNoType', title: '科目類別', width: 100 }
                ]],
                onSelect: function (index, row) {

                },
                onClickRow: function (rowIndex, rowData) {
                    // 將 dgGroup 的背景顏色設為黃色
                    dgGroup.datagrid('getPanel').css({
                        'border-color': 'white',
                        'border-width': '0px', // 设置边框宽度为2像素，你可以根据需要调整宽度值
                        'border-style': 'solid' // 设置边框样式为实线
                    });
                    // 將其他 DataGrid 的背景顏色設為白色
                    dgNo.datagrid('getPanel').css({
                        'border-color': 'yellow',
                        'border-width': '5px', // 设置边框宽度为2像素，你可以根据需要调整宽度值
                        'border-style': 'solid' // 设置边框样式为实线
                    });
                    focusdg = 'dgNo';
                },
            });
            dgNodata();
        }
        //dg會計分類，填值
        function dgNodata(docid) {
            if (docid != null) {
                actionurl = defaultUrl + controllerurl + functionurl + 'GetAccCode2?docid=' + docid;
                $.ajax({
                    type: "GET",
                    url: actionurl,
                    dataType: "json",
                    success: function (data) {
                        if (data == "C0003") {
                            $.messager.alert('alert', '無會計分類資料!');
                            console.log("C0003: Not Found");
                        } else {
                            dgNo.datagrid('loadData', data);
                        }
                    },
                    error: function (xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            }
        }
        //#endregion

        //#region 按鈕動作
        function btnClick(type) {
            switch (type) {
                //#region dg導覽
                case 'first':
                    break;
                case 'previous':
                    break;
                case 'next':
                    break;
                case 'last':
                    break;
                //#endregion
                //#region dg資料動作
                case 'search':
                    break;
                case 'add':
                    break;
                case 'edit':
                    break;
                case 'save':
                    break;
                case 'refresh':
                    break;
                case 'cancel':
                    break;
                case 'delete':
                    break;
                //#endregion
            }
        }
        //#endregion

        //#region 功能函式
        // 自定義doajax
        function doajax(type, url, data, successCallback, errorCallback) {
            $.ajax({
                type: type,
                url: url,
                data: data,
                success: function (response) {
                    if (typeof successCallback === 'function') {
                        successCallback(response);
                    }
                },
                error: function (xhr, status, errorThrown) {
                    if (typeof errorCallback === 'function') {
                        errorCallback(xhr, status, errorThrown);
                    }
                }
            });
        }


            //#endregion
    </script>
}